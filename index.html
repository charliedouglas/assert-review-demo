<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>assert-review — FCA Compliance Note Evaluation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { 50:'#eef2ff', 100:'#e0e7ff', 200:'#c7d2fe', 300:'#a5b4fc', 400:'#818cf8', 500:'#6366f1', 600:'#4f46e5', 700:'#4338ca', 800:'#3730a3', 900:'#312e81' },
                        surface: { 800:'#1e1b2e', 900:'#13111c', 950:'#0c0a14' }
                    }
                }
            }
        }
    </script>
    <style>
        body { background: #0c0a14; }
        .score-bar-fill { transition: width 1.2s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
        .fade-in { animation: fadeIn 0.6s ease-out forwards; opacity: 0; }
        @keyframes fadeIn { to { opacity: 1; } }
        @keyframes pulse-dot { 0%, 80%, 100% { opacity: 0.3; } 40% { opacity: 1; } }
        .dot-1 { animation: pulse-dot 1.4s infinite; }
        .dot-2 { animation: pulse-dot 1.4s infinite 0.2s; }
        .dot-3 { animation: pulse-dot 1.4s infinite 0.4s; }
        pre code { font-size: 0.85rem; }
        textarea { font-size: 0.85rem; }
        .element-row { transition: all 0.3s ease; }
        .element-row:hover { background: rgba(99,102,241,0.05); }
    </style>
</head>
<body class="text-gray-200 min-h-screen">

    <!-- Nav -->
    <nav class="border-b border-white/5 backdrop-blur-sm sticky top-0 z-50 bg-surface-950/80">
        <div class="max-w-6xl mx-auto px-6 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-lg bg-brand-600 flex items-center justify-center font-bold text-white text-sm">A</div>
                <span class="font-semibold text-white">assert-review</span>
                <span class="text-xs text-gray-500 border border-gray-700 rounded px-1.5 py-0.5">v0.1.0</span>
            </div>
            <div class="flex items-center gap-6 text-sm">
                <a href="#demo" class="text-gray-400 hover:text-white transition">Demo</a>
                <a href="#elements" class="text-gray-400 hover:text-white transition">Framework</a>
                <a href="#quickstart" class="text-gray-400 hover:text-white transition">Quick Start</a>
                <a href="https://github.com/charliedouglas/assert_llm_tools" target="_blank" class="text-gray-400 hover:text-white transition flex items-center gap-1">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/></svg>
                    GitHub
                </a>
            </div>
        </div>
    </nav>

    <!-- Hero -->
    <section class="max-w-6xl mx-auto px-6 pt-20 pb-16">
        <div class="max-w-3xl">
            <div class="inline-flex items-center gap-2 text-xs font-medium text-brand-400 bg-brand-500/10 border border-brand-500/20 rounded-full px-3 py-1 mb-6">
                <span class="w-1.5 h-1.5 rounded-full bg-brand-400"></span>
                FCA Suitability Framework — COBS 9.2
            </div>
            <h1 class="text-4xl sm:text-5xl font-bold text-white leading-tight mb-6">
                Automated compliance evaluation<br>
                <span class="text-brand-400">for adviser suitability notes</span>
            </h1>
            <p class="text-lg text-gray-400 mb-8 leading-relaxed">
                <strong class="text-gray-300">assert-review</strong> uses LLM-based analysis to evaluate financial adviser meeting notes against the FCA suitability framework. It returns structured gap reports with per-element scores, evidence quotes, and actionable remediation suggestions.
            </p>
            <div class="flex items-center gap-4">
                <code class="bg-surface-800 border border-white/10 rounded-lg px-4 py-2.5 text-sm font-mono text-brand-300">pip install assert-review</code>
                <a href="#demo" class="bg-brand-600 hover:bg-brand-700 text-white px-5 py-2.5 rounded-lg text-sm font-medium transition">Try the demo ↓</a>
            </div>
        </div>
    </section>

    <!-- Demo Section -->
    <section id="demo" class="max-w-6xl mx-auto px-6 py-16">
        <h2 class="text-2xl font-bold text-white mb-2">Interactive Demo</h2>
        <p class="text-gray-400 mb-8">Paste an adviser note or use the sample below. The demo simulates an LLM evaluation against the FCA suitability framework.</p>

        <!-- Input Panel -->
        <div class="bg-surface-800 border border-white/5 rounded-2xl overflow-hidden">
            <div class="p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-sm font-semibold text-gray-300 uppercase tracking-wider">Adviser Suitability Note</h3>
                    <button onclick="loadSample()" class="text-xs text-brand-400 hover:text-brand-300 transition">Load sample note</button>
                </div>
                <textarea id="noteInput" rows="14" class="w-full bg-surface-900 border border-white/10 rounded-xl p-4 text-gray-300 placeholder-gray-600 focus:outline-none focus:border-brand-500/50 resize-none font-mono leading-relaxed" placeholder="Paste an adviser suitability note here..."></textarea>
            </div>

            <div class="px-6 pb-6">
                <button id="runBtn" onclick="runEvaluation()" class="bg-brand-600 hover:bg-brand-700 text-white px-6 py-3 rounded-xl text-sm font-medium transition flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                    Run FCA Evaluation
                </button>
            </div>
        </div>

        <!-- Loading -->
        <div id="loading" class="hidden mt-8 text-center py-12">
            <div class="inline-flex items-center gap-1 text-brand-400 text-lg">
                <span>Evaluating against FCA framework</span>
                <span class="dot-1">.</span><span class="dot-2">.</span><span class="dot-3">.</span>
            </div>
            <p class="text-gray-500 text-sm mt-2">Analysing 9 suitability elements</p>
        </div>

        <!-- Results -->
        <div id="results" class="hidden mt-8 space-y-6 fade-in">
            <!-- Overall Score -->
            <div class="bg-surface-800 border border-white/5 rounded-2xl p-6">
                <div class="flex items-center justify-between mb-6">
                    <div>
                        <h3 class="text-lg font-bold text-white">Evaluation Result</h3>
                        <p class="text-sm text-gray-400 mt-1">FCA Suitability Note Framework v1.0.0 — COBS 9.2</p>
                    </div>
                    <div id="overallBadge" class="px-4 py-2 rounded-full text-sm font-semibold"></div>
                </div>

                <!-- Score Ring -->
                <div class="flex items-center gap-8 mb-8">
                    <div class="relative w-28 h-28">
                        <svg class="w-28 h-28 -rotate-90" viewBox="0 0 100 100">
                            <circle cx="50" cy="50" r="42" stroke="#1e1b2e" stroke-width="8" fill="none"/>
                            <circle id="scoreRing" cx="50" cy="50" r="42" stroke="#6366f1" stroke-width="8" fill="none"
                                stroke-dasharray="263.9" stroke-dashoffset="263.9" stroke-linecap="round"
                                style="transition: stroke-dashoffset 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)"/>
                        </svg>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <span id="scoreValue" class="text-2xl font-bold text-white">0</span>
                        </div>
                    </div>
                    <div id="statsSummary" class="text-sm text-gray-400 space-y-1"></div>
                </div>

                <!-- Summary -->
                <div id="summaryText" class="bg-surface-900 rounded-xl p-4 text-sm text-gray-300 leading-relaxed border border-white/5"></div>
            </div>

            <!-- Per-element results -->
            <div class="bg-surface-800 border border-white/5 rounded-2xl overflow-hidden">
                <div class="p-6 border-b border-white/5">
                    <h3 class="text-lg font-bold text-white">Element-by-Element Analysis</h3>
                    <p class="text-sm text-gray-400 mt-1">Each element of the FCA suitability framework evaluated individually</p>
                </div>
                <div id="elementResults" class="divide-y divide-white/5"></div>
            </div>
        </div>
    </section>

    <!-- Framework Elements -->
    <section id="elements" class="max-w-6xl mx-auto px-6 py-16">
        <h2 class="text-2xl font-bold text-white mb-2">FCA Suitability Framework</h2>
        <p class="text-gray-400 mb-8">The 9 elements evaluated under COBS 9.2 suitability requirements.</p>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="bg-surface-800 border border-white/5 rounded-xl p-5">
                <div class="flex items-center gap-2 mb-3">
                    <span class="w-2 h-2 rounded-full bg-red-400"></span>
                    <span class="text-xs font-medium text-red-400 uppercase">Critical</span>
                </div>
                <h3 class="font-semibold text-white text-sm mb-2">Client Objectives</h3>
                <p class="text-xs text-gray-400 leading-relaxed">Investment objectives including time horizon, purpose, and specific goals or constraints.</p>
            </div>
            <div class="bg-surface-800 border border-white/5 rounded-xl p-5">
                <div class="flex items-center gap-2 mb-3">
                    <span class="w-2 h-2 rounded-full bg-red-400"></span>
                    <span class="text-xs font-medium text-red-400 uppercase">Critical</span>
                </div>
                <h3 class="font-semibold text-white text-sm mb-2">Risk Attitude</h3>
                <p class="text-xs text-gray-400 leading-relaxed">Client's ATR including risk profiling outcome and assigned risk category.</p>
            </div>
            <div class="bg-surface-800 border border-white/5 rounded-xl p-5">
                <div class="flex items-center gap-2 mb-3">
                    <span class="w-2 h-2 rounded-full bg-red-400"></span>
                    <span class="text-xs font-medium text-red-400 uppercase">Critical</span>
                </div>
                <h3 class="font-semibold text-white text-sm mb-2">Capacity for Loss</h3>
                <p class="text-xs text-gray-400 leading-relaxed">Whether the client can sustain capital loss without materially impacting living standards.</p>
            </div>
            <div class="bg-surface-800 border border-white/5 rounded-xl p-5">
                <div class="flex items-center gap-2 mb-3">
                    <span class="w-2 h-2 rounded-full bg-orange-400"></span>
                    <span class="text-xs font-medium text-orange-400 uppercase">High</span>
                </div>
                <h3 class="font-semibold text-white text-sm mb-2">Financial Situation</h3>
                <p class="text-xs text-gray-400 leading-relaxed">Income, expenditure, assets, liabilities, and existing holdings.</p>
            </div>
            <div class="bg-surface-800 border border-white/5 rounded-xl p-5">
                <div class="flex items-center gap-2 mb-3">
                    <span class="w-2 h-2 rounded-full bg-orange-400"></span>
                    <span class="text-xs font-medium text-orange-400 uppercase">High</span>
                </div>
                <h3 class="font-semibold text-white text-sm mb-2">Knowledge & Experience</h3>
                <p class="text-xs text-gray-400 leading-relaxed">Client's familiarity with the relevant investment type per MiFID II principles.</p>
            </div>
            <div class="bg-surface-800 border border-white/5 rounded-xl p-5">
                <div class="flex items-center gap-2 mb-3">
                    <span class="w-2 h-2 rounded-full bg-red-400"></span>
                    <span class="text-xs font-medium text-red-400 uppercase">Critical</span>
                </div>
                <h3 class="font-semibold text-white text-sm mb-2">Recommendation Rationale</h3>
                <p class="text-xs text-gray-400 leading-relaxed">Why the product is suitable, linking back to objectives, risk, and financial situation.</p>
            </div>
            <div class="bg-surface-800 border border-white/5 rounded-xl p-5">
                <div class="flex items-center gap-2 mb-3">
                    <span class="w-2 h-2 rounded-full bg-orange-400"></span>
                    <span class="text-xs font-medium text-orange-400 uppercase">High</span>
                </div>
                <h3 class="font-semibold text-white text-sm mb-2">Charges & Costs</h3>
                <p class="text-xs text-gray-400 leading-relaxed">All relevant charges including ongoing and one-off fees for products and advice.</p>
            </div>
            <div class="bg-surface-800 border border-white/5 rounded-xl p-5">
                <div class="flex items-center gap-2 mb-3">
                    <span class="w-2 h-2 rounded-full bg-yellow-400"></span>
                    <span class="text-xs font-medium text-yellow-400 uppercase">Medium</span>
                </div>
                <h3 class="font-semibold text-white text-sm mb-2">Alternatives Considered</h3>
                <p class="text-xs text-gray-400 leading-relaxed">Whether alternative products or strategies were considered and why the recommendation was preferred.</p>
            </div>
            <div class="bg-surface-800 border border-white/5 rounded-xl p-5">
                <div class="flex items-center gap-2 mb-3">
                    <span class="w-2 h-2 rounded-full bg-gray-400"></span>
                    <span class="text-xs font-medium text-gray-400 uppercase">Low</span>
                </div>
                <h3 class="font-semibold text-white text-sm mb-2">Client Confirmation</h3>
                <p class="text-xs text-gray-400 leading-relaxed">That the client received, understood, and acknowledged the recommendation.</p>
            </div>
        </div>
    </section>

    <!-- Quick Start -->
    <section id="quickstart" class="max-w-6xl mx-auto px-6 py-16">
        <h2 class="text-2xl font-bold text-white mb-2">Quick Start</h2>
        <p class="text-gray-400 mb-8">Evaluate an adviser note in 5 lines of Python.</p>
        <div class="bg-surface-800 border border-white/5 rounded-2xl overflow-hidden">
            <div class="flex items-center justify-between px-5 py-3 border-b border-white/5 bg-surface-900">
                <span class="text-xs text-gray-500 font-mono">python</span>
                <button onclick="copyCode()" class="text-xs text-gray-500 hover:text-white transition">Copy</button>
            </div>
            <pre class="p-5 overflow-x-auto"><code id="codeBlock" class="text-gray-300 font-mono"><span class="text-brand-400">from</span> assert_review <span class="text-brand-400">import</span> evaluate_note, LLMConfig

config = LLMConfig(
    provider=<span class="text-green-400">"bedrock"</span>,
    model_id=<span class="text-green-400">"us.amazon.nova-pro-v1:0"</span>,
    region=<span class="text-green-400">"us-east-1"</span>,
)

report = evaluate_note(
    note_text=<span class="text-green-400">"Client meeting note text..."</span>,
    framework=<span class="text-green-400">"fca_suitability_v1"</span>,
    llm_config=config,
)

<span class="text-gray-500"># Overall result</span>
print(report.overall_rating)   <span class="text-gray-500"># "Minor Gaps"</span>
print(report.overall_score)    <span class="text-gray-500"># 0.82</span>
print(report.passed)           <span class="text-gray-500"># True</span>

<span class="text-gray-500"># Per-element breakdown</span>
<span class="text-brand-400">for</span> item <span class="text-brand-400">in</span> report.items:
    print(<span class="text-green-400">f"</span>{item.element_id}: {item.status} ({item.score:.2f})<span class="text-green-400">"</span>)
    <span class="text-brand-400">for</span> s <span class="text-brand-400">in</span> item.suggestions:
        print(<span class="text-green-400">f"  → </span>{s}<span class="text-green-400">"</span>)</code></pre>
        </div>
    </section>

    <!-- Footer -->
    <footer class="border-t border-white/5 mt-16">
        <div class="max-w-6xl mx-auto px-6 py-8 flex items-center justify-between text-sm text-gray-500">
            <div class="flex items-center gap-3">
                <div class="w-6 h-6 rounded bg-brand-600 flex items-center justify-center font-bold text-white text-xs">A</div>
                <span>assert-review</span>
                <span class="text-gray-700">·</span>
                <span>MIT License</span>
            </div>
            <div class="flex items-center gap-4">
                <a href="https://pypi.org/project/assert-review/" target="_blank" class="hover:text-white transition">PyPI</a>
                <a href="https://github.com/charliedouglas/assert_llm_tools" target="_blank" class="hover:text-white transition">GitHub</a>
            </div>
        </div>
    </footer>

<script>
const SAMPLE_NOTE = `Annual Review Meeting — Mrs Sarah Henderson
Date: 14 January 2026 | Adviser: James Mitchell, DipPFS

Mrs Henderson attended for her annual investment review. She is 58 years old, planning to retire at 63. Her primary objective remains generating a sustainable retirement income from age 63, supplemented by her defined benefit pension (estimated £12,400 p.a. from age 60). She also wishes to maintain a capital reserve for potential care costs in later life.

Risk profile was reassessed using our standard questionnaire. Mrs Henderson scored 5/10, consistent with a "Balanced" risk category — unchanged from last year. She confirmed she is comfortable with moderate fluctuations in portfolio value provided the long-term growth trajectory is maintained.

Regarding capacity for loss: Mrs Henderson's essential expenditure is approximately £2,100/month. Her DB pension and State Pension (from age 67) will cover £1,850/month of this. She has £28,000 in an easy-access savings account as an emergency fund. I confirmed that a significant loss in her investment portfolio would reduce her retirement options but would not compromise her ability to meet essential living costs.

Current financial position: salary £52,000 (NHS Band 8a), monthly surplus after expenses approximately £800. Existing portfolio: Vanguard LifeStrategy 60% via Transact platform, current value £187,400 (ISA: £142,000, GIA: £45,400). No outstanding debts other than mortgage (£64,000 remaining, 7 years).

Mrs Henderson has held ISA investments for 12 years and understands the risk-return relationship for multi-asset funds. She has no experience with direct equity or alternative investments.

Recommendation: Maintain current allocation in Vanguard LifeStrategy 60%, which provides global equity and bond diversification consistent with her balanced risk profile and 5-year time horizon to retirement. The fund's 0.22% OCF remains competitive. Platform fee: 0.15% (Transact). Adviser fee: 0.5% ongoing, equating to approximately £937/year at current portfolio value. Total cost: 0.87%.

I discussed whether a higher equity allocation might be appropriate given the 5-year horizon, but Mrs Henderson preferred to maintain the current balanced approach given her proximity to retirement. We also considered moving to a lower-cost platform but concluded that Transact's functionality and consolidation benefits justify the marginal cost difference.

Mrs Henderson confirmed she was happy with the recommendation and asked me to proceed. A copy of this suitability report will be issued within 5 working days.`;

const SIMULATED_RESULTS = {
    overall_score: 0.91,
    overall_rating: "Minor Gaps",
    passed: true,
    summary: "This is a well-constructed suitability note that addresses the vast majority of FCA requirements under COBS 9.2. All critical elements — client objectives, risk attitude, capacity for loss, and recommendation rationale — are clearly documented with specific, personalised detail. Financial situation is thoroughly recorded with concrete figures. The note demonstrates good practice in linking the recommendation explicitly to the client's profile. Minor gaps exist in the formal structure of alternatives analysis, though alternatives were discussed. Overall, this note would meet regulatory expectations in a file review.",
    items: [
        { element_id: "client_objectives", status: "present", score: 0.95, severity: "critical", required: true,
          evidence: "Planning to retire at 63. Primary objective: generating sustainable retirement income from age 63, supplemented by DB pension. Also wishes to maintain capital reserve for potential care costs.",
          suggestions: [] },
        { element_id: "risk_attitude", status: "present", score: 0.95, severity: "critical", required: true,
          evidence: "Scored 5/10 on standard questionnaire, consistent with 'Balanced' risk category. Confirmed comfortable with moderate fluctuations provided long-term growth trajectory maintained.",
          suggestions: [] },
        { element_id: "capacity_for_loss", status: "present", score: 0.92, severity: "critical", required: true,
          evidence: "Essential expenditure £2,100/month. DB + State Pension cover £1,850/month. Emergency fund of £28,000. Significant loss would reduce retirement options but not compromise essential living costs.",
          suggestions: [] },
        { element_id: "financial_situation", status: "present", score: 0.95, severity: "high", required: true,
          evidence: "Salary £52,000, monthly surplus £800. Portfolio £187,400 (ISA £142,000 + GIA £45,400). Mortgage £64,000 remaining. Emergency savings £28,000.",
          suggestions: [] },
        { element_id: "knowledge_and_experience", status: "present", score: 0.88, severity: "high", required: true,
          evidence: "Held ISA investments for 12 years. Understands risk-return relationship for multi-asset funds. No experience with direct equity or alternatives.",
          suggestions: ["Consider documenting the specific types of investments the client has previously held beyond ISAs to demonstrate breadth of assessment."] },
        { element_id: "recommendation_rationale", status: "present", score: 0.94, severity: "critical", required: true,
          evidence: "Maintain Vanguard LifeStrategy 60% — global equity and bond diversification consistent with balanced risk profile and 5-year horizon. Links recommendation to documented profile.",
          suggestions: [] },
        { element_id: "charges_and_costs", status: "present", score: 0.96, severity: "high", required: true,
          evidence: "OCF 0.22%, platform fee 0.15% (Transact), adviser fee 0.5% ongoing (£937/year). Total cost 0.87%.",
          suggestions: [] },
        { element_id: "alternatives_considered", status: "partial", score: 0.72, severity: "medium", required: false,
          evidence: "Discussed higher equity allocation but client preferred balanced approach. Considered lower-cost platform but concluded Transact justified.",
          suggestions: ["Consider documenting alternatives in a more structured format — a brief comparison of the options considered and the specific reasons for rejection would strengthen the file."] },
        { element_id: "client_confirmation", status: "present", score: 0.85, severity: "low", required: false,
          evidence: "Mrs Henderson confirmed she was happy with the recommendation. Suitability report to be issued within 5 working days.",
          suggestions: ["Consider recording whether the client was informed of their right to cancel or withdraw within the cooling-off period."] }
    ]
};

function loadSample() {
    document.getElementById('noteInput').value = SAMPLE_NOTE;
}

function runEvaluation() {
    const note = document.getElementById('noteInput').value.trim();
    if (!note) { alert('Please enter or load a sample note first.'); return; }

    document.getElementById('results').classList.add('hidden');
    document.getElementById('loading').classList.remove('hidden');
    document.getElementById('runBtn').disabled = true;
    document.getElementById('runBtn').classList.add('opacity-50');

    setTimeout(() => {
        document.getElementById('loading').classList.add('hidden');
        renderResults(SIMULATED_RESULTS);
        document.getElementById('runBtn').disabled = false;
        document.getElementById('runBtn').classList.remove('opacity-50');
    }, 2800);
}

function renderResults(data) {
    const resultsEl = document.getElementById('results');
    resultsEl.classList.remove('hidden');

    // Overall badge
    const badge = document.getElementById('overallBadge');
    const badgeColors = {
        'Compliant': 'bg-green-500/10 text-green-400 border border-green-500/20',
        'Minor Gaps': 'bg-yellow-500/10 text-yellow-400 border border-yellow-500/20',
        'Requires Attention': 'bg-orange-500/10 text-orange-400 border border-orange-500/20',
        'Non-Compliant': 'bg-red-500/10 text-red-400 border border-red-500/20'
    };
    badge.className = `px-4 py-2 rounded-full text-sm font-semibold ${badgeColors[data.overall_rating] || ''}`;
    badge.textContent = data.passed ? `✓ ${data.overall_rating}` : `✗ ${data.overall_rating}`;

    // Score ring
    const ring = document.getElementById('scoreRing');
    const circumference = 2 * Math.PI * 42;
    setTimeout(() => {
        ring.style.strokeDashoffset = circumference * (1 - data.overall_score);
        ring.style.stroke = data.overall_score >= 0.8 ? '#22c55e' : data.overall_score >= 0.6 ? '#f59e0b' : '#ef4444';
    }, 100);

    // Animate score number
    const scoreEl = document.getElementById('scoreValue');
    let current = 0;
    const target = data.overall_score;
    const step = target / 40;
    const interval = setInterval(() => {
        current += step;
        if (current >= target) { current = target; clearInterval(interval); }
        scoreEl.textContent = current.toFixed(2);
    }, 30);

    // Stats
    const present = data.items.filter(i => i.status === 'present').length;
    const partial = data.items.filter(i => i.status === 'partial').length;
    const missing = data.items.filter(i => i.status === 'missing').length;
    document.getElementById('statsSummary').innerHTML = `
        <div class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-green-400"></span> ${present} elements present</div>
        <div class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-yellow-400"></span> ${partial} elements partial</div>
        <div class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-red-400"></span> ${missing} elements missing</div>
        <div class="mt-2 text-gray-500">${data.items.length} elements evaluated</div>
    `;

    // Summary
    document.getElementById('summaryText').textContent = data.summary;

    // Elements
    const container = document.getElementById('elementResults');
    container.innerHTML = '';
    data.items.forEach((item, idx) => {
        const statusColors = { present: 'text-green-400', partial: 'text-yellow-400', missing: 'text-red-400' };
        const statusIcons = { present: '✓', partial: '◐', missing: '✗' };
        const severityColors = { critical: 'text-red-400', high: 'text-orange-400', medium: 'text-yellow-400', low: 'text-gray-400' };
        const barColor = item.score >= 0.8 ? 'bg-green-500' : item.score >= 0.6 ? 'bg-yellow-500' : 'bg-red-500';
        const name = item.element_id.replace(/_/g, ' ').replace(/\b\w/g, c => c.toUpperCase());

        const row = document.createElement('div');
        row.className = 'element-row p-5';
        row.style.animationDelay = `${idx * 0.08}s`;
        row.innerHTML = `
            <div class="flex items-start justify-between mb-3">
                <div class="flex items-center gap-3">
                    <span class="text-lg ${statusColors[item.status]}">${statusIcons[item.status]}</span>
                    <div>
                        <span class="font-semibold text-white text-sm">${name}</span>
                        <div class="flex items-center gap-2 mt-0.5">
                            <span class="text-xs ${severityColors[item.severity]} uppercase">${item.severity}</span>
                            <span class="text-xs text-gray-600">·</span>
                            <span class="text-xs text-gray-500">${item.required ? 'Required' : 'Optional'}</span>
                        </div>
                    </div>
                </div>
                <span class="text-sm font-mono font-semibold ${statusColors[item.status]}">${item.score.toFixed(2)}</span>
            </div>
            <div class="w-full bg-surface-900 rounded-full h-1.5 mb-3">
                <div class="score-bar-fill ${barColor} h-1.5 rounded-full" style="width: 0%"></div>
            </div>
            ${item.evidence ? `<div class="bg-surface-900 rounded-lg p-3 mb-2 text-xs text-gray-400 border-l-2 border-brand-600/30"><span class="text-gray-500 font-medium">Evidence:</span> "${item.evidence}"</div>` : ''}
            ${item.suggestions.length ? item.suggestions.map(s => `<div class="flex items-start gap-2 text-xs text-yellow-400/80 mt-2"><span>→</span><span>${s}</span></div>`).join('') : ''}
        `;
        container.appendChild(row);

        // Animate bar
        setTimeout(() => {
            row.querySelector('.score-bar-fill').style.width = `${item.score * 100}%`;
        }, 200 + idx * 100);
    });
}

function copyCode() {
    const code = document.getElementById('codeBlock').textContent;
    navigator.clipboard.writeText(code);
}

// Load sample on page load
document.addEventListener('DOMContentLoaded', loadSample);
</script>

</body>
</html>
